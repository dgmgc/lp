<!DOCTYPE html>
<html>
<head>
    <title>WebOS Diagnostics</title>
</head>
<body>
    <div id="diagnostics"></div>
    
    <script>
        (function runDiagnostics() {
            var features = {
                'ES6 const': (function() { 
                    try { 
                        // Более строгая проверка const
                        eval('(function() { const x = 1; if (true) { const y = 2; } return x; })()'); 
                        return true; 
                    } catch(e) { 
                        console.log('const error:', e);
                        return false; 
                    } 
                })(),
                'ES6 let': (function() { 
                    try { 
                        eval('(function() { let x = 1; if (true) { let y = 2; } return x; })()'); 
                        return true; 
                    } catch(e) { 
                        console.log('let error:', e);
                        return false; 
                    } 
                })(),
                'Arrow functions': (function() { 
                    try { 
                        eval('var f = () => 42;'); 
                        return f() === 42; 
                    } catch(e) { 
                        return false; 
                    } 
                })(),
                'Array.includes': (function() {
                    try {
                        return [1,2,3].includes(2) === true;
                    } catch(e) {
                        return false;
                    }
                })(),
                'URL Constructor': (function() { 
                    try { 
                        var url = new URL('http://test.com');
                        return url.href === 'http://test.com/'; 
                    } catch(e) { 
                        return false; 
                    } 
                })(),
                'document.currentScript': !!document.currentScript,
                'Promises': (function() {
                    try {
                        return typeof Promise !== 'undefined' && 
                               Promise.resolve(1).then(function(x) { return x + 1; });
                    } catch(e) {
                        return false;
                    }
                })(),
                'Fetch API': typeof fetch !== 'undefined',
                'CSS Grid': CSS.supports ? CSS.supports('display', 'grid') : false,
                'CSS Flexbox': CSS.supports ? CSS.supports('display', 'flex') : false
            };
            
            var result = '<h2>WebOS Diagnostics</h2>';
            result += '<p><strong>User Agent:</strong> ' + navigator.userAgent + '</p>';
            result += '<p><strong>Platform:</strong> ' + navigator.platform + '</p>';
            result += '<h3>Feature Support:</h3><ul>';
            
            for (var feature in features) {
                result += '<li>' + feature + ': <strong>' + 
                         (features[feature] ? '✅ SUPPORTED' : '❌ NOT SUPPORTED') + 
                         '</strong></li>';
            }
            result += '</ul>';
            
            document.getElementById('diagnostics').innerHTML = result;
            
            // Вывод в консоль
            console.log('=== WebOS Diagnostics ===');
            console.log('UA:', navigator.userAgent);
            console.log('Features:', features);
        })();
    </script>
</body>
</html>
